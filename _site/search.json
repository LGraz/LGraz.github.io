[
  {
    "objectID": "posts/lmm-effect-of-block-variance/lmm-effect-of-block-variance.html",
    "href": "posts/lmm-effect-of-block-variance/lmm-effect-of-block-variance.html",
    "title": "Does the variance of the Random-Effect influence the p-values?",
    "section": "",
    "text": "We study the classical setup of a randomized complete block design with 2 treatments, 2 replications per block and 5 blocks. We vary the variance of the block effect and study how the p-values of the treatment effect change.\n\\[\n% equatiomatic::extract_eq(fit)\n\\begin{aligned}\n  \\operatorname{y}_{i}  &\\sim N \\left(\\alpha_{block(i)} + \\beta_{trt(i)}, \\sigma^2 \\right) \\\\\n    \\alpha_{j}  &\\sim N \\left(\\mu_{\\alpha_{j}}, {\\sigma_{\\alpha_{j}}}^2 \\right)\n    \\text{, for block j = 1,} \\dots \\text{,5}\\\\\n    % contr sum for \\beta_{trt(i)}:\n    \\beta_{1}  &= - \\beta_{2}  \\quad \\text{(contr.sum)}\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "posts/lmm-effect-of-block-variance/lmm-effect-of-block-variance.html#simulate-data",
    "href": "posts/lmm-effect-of-block-variance/lmm-effect-of-block-variance.html#simulate-data",
    "title": "Does the variance of the Random-Effect influence the p-values?",
    "section": "Simulate Data",
    "text": "Simulate Data\n\nlibrary(ggplot2)\nlibrary(gridExtra)\nlibrary(lmerTest)\nlibrary(multcomp)\n\noptions(contrasts = c(\"contr.sum\", \"contr.poly\"))\n\n\n# simulate data for a linear mixed model\n# a randomized complete block design with 3 treatments, nblock blocks, nrep replicates per block\n# an observation error with standard deviation SD_noise and a block effect with standard deviation SD_block\n# a treatment effect with standard deviation SD_trt\nget_data &lt;- function(nblock=5, nrep=2, SD_noise=3, SD_block=1, SD_trt=0) {\n  data &lt;- expand.grid(\n    nrep = 1:nrep,\n    trt = as.factor(1:2),\n    block = as.factor(1:nblock)\n  )\n  block_effect &lt;- SD_block * rnorm(nblock)[data$block]\n  noise &lt;- SD_noise * rnorm(nrow(data))\n  trt_effect &lt;- SD_trt * rnorm(nrow(data))[data$trt]\n  data$y &lt;- trt_effect + block_effect + noise\n  data\n}"
  },
  {
    "objectID": "posts/lmm-effect-of-block-variance/lmm-effect-of-block-variance.html#plot-function",
    "href": "posts/lmm-effect-of-block-variance/lmm-effect-of-block-variance.html#plot-function",
    "title": "Does the variance of the Random-Effect influence the p-values?",
    "section": "Plot Function",
    "text": "Plot Function\n\n# function that makes an interactions plot\nplot_interactions &lt;- function(data, ...) {\n  with(data,\n  interaction.plot(\n      x.factor = trt,\n      trace.factor = block,\n      response = y,\n      type = \"b\",\n      legend = FALSE,\n      ...\n    )\n  )\n}"
  },
  {
    "objectID": "posts/lmm-effect-of-block-variance/lmm-effect-of-block-variance.html#perform-analysis",
    "href": "posts/lmm-effect-of-block-variance/lmm-effect-of-block-variance.html#perform-analysis",
    "title": "Does the variance of the Random-Effect influence the p-values?",
    "section": "Perform Analysis",
    "text": "Perform Analysis\n\nGet Data that only differs with respect to SD_block (increasing)\n\nPlot the data for each SD_block\nFit a model with lmer and lm for each SD_block\n\ninspect how the estimates and standard errors of the treatmenteffect change with increasing SD_block\n\n\nSD_blocks &lt;- 0:8\nfits &lt;- vector(\"list\", length(SD_blocks)*2)\ndim(fits) &lt;- c(length(SD_blocks), 2)\ndimnames(fits) &lt;- list(paste0(\"SD_block=\",as.character(SD_blocks)), c(\"lmer\", \"lm\"))\n\npar(mfrow=c(3,3))\nfor(i in seq_along(SD_blocks)){\n  SD_block &lt;- SD_blocks[i]\n\n  set.seed(2)\n  data &lt;- get_data(SD_block=SD_block)\n  plot_interactions(data, main=paste0(\"SD_block=\", SD_block))\n  \n  # lmer\n  fits[[i,1]] &lt;- lmer(y ~ trt + (1|block), data=data)\n  \n  # lm\n  fits[[i,2]] &lt;- lm(y ~ trt + block, data=data)\n}; par(mfrow=c(1,1))\n\nboundary (singular) fit: see help('isSingular')\nboundary (singular) fit: see help('isSingular')\nboundary (singular) fit: see help('isSingular')\n\n\n\n\n\n\n\n\n# apply a function to each element of a list-array\n# preserving the dimensions and dimnames\nelementwise_apply &lt;- function(L, f){\n  L_applied &lt;- lapply(L, f)\n  dim(L_applied) &lt;- dim(L)\n  dimnames(L_applied) &lt;- dimnames(L)\n  L_applied\n}\n\nsummary_coef_trt1 &lt;- elementwise_apply(fits, function(fit) coef(summary(fit))[\"trt1\",])"
  },
  {
    "objectID": "posts/lmm-effect-of-block-variance/lmm-effect-of-block-variance.html#results",
    "href": "posts/lmm-effect-of-block-variance/lmm-effect-of-block-variance.html#results",
    "title": "Does the variance of the Random-Effect influence the p-values?",
    "section": "Results",
    "text": "Results\nIllustration: How summary_coef_trt1 looks like:\n\nsummary_coef_trt1[\"SD_block=5\",]\n\n$lmer\n  Estimate Std. Error         df    t value   Pr(&gt;|t|) \n-0.3125844  0.8561637 14.0000000 -0.3650989  0.7204942 \n\n$lm\n  Estimate Std. Error    t value   Pr(&gt;|t|) \n-0.3125844  0.8561637 -0.3650989  0.7204942 \n\n# estimate\nelementwise_apply(summary_coef_trt1, function(coef) coef[1])\n\n           lmer       lm        \nSD_block=0 -0.3125844 -0.3125844\nSD_block=1 -0.3125844 -0.3125844\nSD_block=2 -0.3125844 -0.3125844\nSD_block=3 -0.3125844 -0.3125844\nSD_block=4 -0.3125844 -0.3125844\nSD_block=5 -0.3125844 -0.3125844\nSD_block=6 -0.3125844 -0.3125844\nSD_block=7 -0.3125844 -0.3125844\nSD_block=8 -0.3125844 -0.3125844\n\n# standard error\nelementwise_apply(summary_coef_trt1, function(coef) coef[2])\n\n           lmer      lm       \nSD_block=0 0.7997087 0.8561637\nSD_block=1 0.7588929 0.8561637\nSD_block=2 0.7842232 0.8561637\nSD_block=3 0.8561637 0.8561637\nSD_block=4 0.8561637 0.8561637\nSD_block=5 0.8561637 0.8561637\nSD_block=6 0.8561637 0.8561637\nSD_block=7 0.8561637 0.8561637\nSD_block=8 0.8561637 0.8561637\n\n# p-value\nelementwise_apply(summary_coef_trt1, function(coef) coef[length(coef)])\n\n           lmer      lm       \nSD_block=0 0.700479  0.7204942\nSD_block=1 0.6852797 0.7204942\nSD_block=2 0.6948831 0.7204942\nSD_block=3 0.7204942 0.7204942\nSD_block=4 0.7204942 0.7204942\nSD_block=5 0.7204942 0.7204942\nSD_block=6 0.7204942 0.7204942\nSD_block=7 0.7204942 0.7204942\nSD_block=8 0.7204942 0.7204942\n\n# random effect variance\nsapply(fits[,1], function(fit) VarCorr(fit)$block[1]) |&gt; sqrt() |&gt; signif(2) \n\nSD_block=0 SD_block=1 SD_block=2 SD_block=3 SD_block=4 SD_block=5 SD_block=6 \n      0.00       0.00       0.00       0.73       2.50       3.70       4.90 \nSD_block=7 SD_block=8 \n      6.00       7.20"
  },
  {
    "objectID": "website/index.html",
    "href": "website/index.html",
    "title": "mytitle",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites."
  },
  {
    "objectID": "statistical-consulting.html",
    "href": "statistical-consulting.html",
    "title": "Statistical Consulting",
    "section": "",
    "text": "I have consulted over 200 clients, including mostly PhD and master’s students as well as professionals from the industry. Discussing these cases in the Statistics Seminar at ETH Zurich has given me a good overview of various methods and the necessary mathematical understanding. Now, it is becoming rare that I cannot deliver a solution.\nFeel free to challenge me! You can contact me via email at stat.consulting.graz@gmail.com"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "mytitle",
    "section": "",
    "text": "Welcome To My Blog\n\n\n\n\n\n\nnews\n\n\n\n\n\n\n\n\n\nNov 15, 2024\n\n\nTristan O’Malley\n\n\n\n\n\n\n\n\n\n\n\n\nDoes the variance of the Random-Effect influence the p-values?\n\n\n\n\n\n\n\n\n\n\n\nDec 18, 2023\n\n\nLukas Graz\n\n\n\n\n\n\n\n\n\n\n\n\nPairwise T-tests can be improved by including more groups\n\n\n\n\n\n\n\n\n\n\n\nApr 14, 2023\n\n\nLukas Graz\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "I am a statistician with a math background. Currently, I enjoy the benefits of being the statistical consultant at ETH. Each client brings another challenge to solve. Thinking about which questions can be answered with which model is what I enjoy the most."
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome To My Blog",
    "section": "",
    "text": "This is the first post in a Quarto blog. Welcome!\n\nSince this post doesn’t specify an explicit image, the first image in the post will be used in the listing page of posts."
  },
  {
    "objectID": "website/about.html",
    "href": "website/about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "posts/ttest-vs-lm-with-more-groups/pairwise-ttest_vs_lm-with-more-groups.html",
    "href": "posts/ttest-vs-lm-with-more-groups/pairwise-ttest_vs_lm-with-more-groups.html",
    "title": "Pairwise T-tests can be improved by including more groups",
    "section": "",
    "text": "TLDR: more groups make the test more stable and slightly more powerful (for low sample sizes). However, be aware that this assumes homoscedasticity (i.e., equal variance for all groups).\n\nget_data &lt;- function(n_per_group = 10, n_groups = 15) {\n  grp &lt;- as.factor(c(rep(1:n_groups, each = n_per_group)))\n  data &lt;- data.frame(group = grp, y = rnorm(n_groups * n_per_group, sd = 2) + as.numeric(grp))\n}\n\n# illustrate data\ndata &lt;- get_data()\nset.seed(123)\nboxplot(y ~ group, data)\n\n\n\n\n\n\n\n# Pairwise T-test using residuals of 2-15 groups\n# plot results\npvals_mat &lt;- replicate(20, { \n  data &lt;- get_data()\n  pvals &lt;- sapply(2:15, function(i) {\n    coefficients(summary(lm(y ~ group, data, subset = group %in% 1:i)))[\"group2\", \"Pr(&gt;|t|)\"]\n  })\n})\n\n# plot each collumn of pvals_mat with matplot\nmatplot(pvals_mat, type = \"l\", xlab = \"How Many Groups Considered +1\")\n\n\n\n\n\n\n\n# simulate power\n# 2 groups vs 5 groups\nn_sim &lt;- 2000\nresults &lt;- matrix(NA, nrow = n_sim, ncol = 2)\nfor (i in 1:n_sim) {\n  data &lt;- get_data(n_per_group = 3, n_groups = 5)\n  results[i, 1] &lt;- coefficients(summary(lm(y ~ group, data, subset = group %in% 1:2)))[\"group2\", \"Pr(&gt;|t|)\"]\n  results[i, 2] &lt;- coefficients(summary(lm(y ~ group, data, subset = group %in% 1:5)))[\"group2\", \"Pr(&gt;|t|)\"]\n}\npower &lt;- apply(results &lt; 0.05, 2, mean)\nnames(power) &lt;- c(\"power using 2 groups,\", \" 5 groups\")\npower\n\npower using 2 groups,              5 groups \n                0.074                 0.081"
  }
]